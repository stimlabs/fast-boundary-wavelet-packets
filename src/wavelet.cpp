#include "wavelet.hpp"

#include <cmath>
#include <stdexcept>

static Wavelet make_haar() {
    double const s = std::sqrt(2.0) / 2.0;
    return Wavelet{
        .name = "haar",
        .dec_lo = { s,  s},
        .dec_hi = {-s,  s},
        .rec_lo = { s,  s},
        .rec_hi = { s, -s},
    };
}

static Wavelet make_db2() {
    return Wavelet{
        .name = "db2",
        .dec_lo = {-0.12940952255126037, 0.2241438680420134,
                    0.8365163037378079,  0.48296291314453416},
        .dec_hi = {-0.48296291314453416, 0.8365163037378079,
                   -0.2241438680420134, -0.12940952255126037},
        .rec_lo = { 0.48296291314453416, 0.8365163037378079,
                    0.2241438680420134, -0.12940952255126037},
        .rec_hi = {-0.12940952255126037, -0.2241438680420134,
                    0.8365163037378079,  -0.48296291314453416},
    };
}

static Wavelet make_db3() {
    return Wavelet{
        .name = "db3",
        .dec_lo = { 0.03522629188570953, -0.08544127388202666,
                   -0.13501102001025458,  0.45987750211849154,
                    0.8068915093110925,   0.33267055295008263},
        .dec_hi = {-0.33267055295008263,  0.8068915093110925,
                   -0.45987750211849154, -0.13501102001025458,
                    0.08544127388202666,  0.03522629188570953},
        .rec_lo = { 0.33267055295008263,  0.8068915093110925,
                    0.45987750211849154, -0.13501102001025458,
                   -0.08544127388202666,  0.03522629188570953},
        .rec_hi = { 0.03522629188570953,  0.08544127388202666,
                   -0.13501102001025458, -0.45987750211849154,
                    0.8068915093110925,  -0.33267055295008263},
    };
}

Wavelet make_wavelet(std::string const& name) {
    if (name == "haar" || name == "db1") {
        return make_haar();
    }
    if (name == "db2") {
        return make_db2();
    }
    if (name == "db3") {
        return make_db3();
    }
    throw std::invalid_argument("Unknown wavelet: " + name);
}
